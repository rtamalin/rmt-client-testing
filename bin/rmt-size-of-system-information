#!/bin/bash

set -eu
if [[ -n "${TRACE:+true}" ]]; then
    set -vx
fi

cmdName=$(basename ${BASH_SOURCE[0]})
binDir=$(readlink -e $(dirname ${BASH_SOURCE[0]}))
dbQuery=${binDir}/rmt-db-query

if [[ ! -x ${dbQuery} ]]; then
    echo "Ensure that the $(basename "${dbQuery}") command is available."
    exit 1
fi

exec \
    ${DEBUG:+echo} \
    ${dbQuery} << _EOF_
SELECT
    COUNT(system_information) AS \`# Systems\`,
    ROUND((SUM(LENGTH(system_information))/1024)/1024, 3) AS \`Total MiB\`
FROM
    systems;
_EOF_
# vim:shiftwidth=4:tabstop=4:expandtab
